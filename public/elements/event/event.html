<link rel="import" href="../../components/polymer/polymer.html">

<link rel="import" href="../../components/paper-card/paper-card.html">
<link rel="import" href="../../components/iron-image/iron-image.html">


<dom-module id="web-event">
    <style>
        /** {*/
            /*border: 1px solid black;*/
        /*}*/
        .event-content {
            display: flex;
        }
        paper-card {
            flex: 1 1 auto;
            margin: 20px;
        }
        .card-content {
            display: flex;
            flex-flow: column wrap;
            padding: 5px;
        }
        .card-content + .card-content {
            border-top: 1px solid #cdcdcd;
        }
        .event-info-box {
            display: flex;
            flex-flow: row wrap;
            flex: 1 1 auto;
        }
        .event-name {
            flex: 1 1 auto;
            font-size: 200%;
            font-weight: bold;
            padding: 5px 15px 5px 5px;
        }
        .event-info-box-small {
            display: flex;
            flex-flow: row wrap;
            flex: 0 1 auto;
            padding: 5px 5px 5px 0px;
        }
        .event-info-box-small > div {
            display: flex;
            flex-flow: column wrap;
            flex: 1 1 auto;
            padding: 5px 20px 5px 5px;
        }
        .event-kind, .event-pdf, .event-date, .event-place {
            flex: 0 1 auto;
            font-weight: bold;
        }
        .event-abstract {
            flex: 0 1 auto;
            padding: 5px;
        }
        .event-speaker {
            display: flex;
            flex-flow: row wrap;
            flex: 0 1 auto;
            text-decoration: none;
            color: black;
        }
        .event-speaker-img {
            height: 100px;
            width: 100px;
            flex: 0 1 auto;
        }
        .event-speaker-info {
            display: flex;
            flex-flow: column wrap;
            flex: 0 1 auto;
        }
        .event-speaker-name, .event-speaker-org {
            flex: 0 1 auto;
        }
        .event-speaker-org {
            color: #a5a5a5;
        }

    </style>
    <template>
        <div class="event-content">
            <paper-card>
                <div class="card-content">
                    <div class="event-info-box">
                        <div class="event-name">[[event.name]]</div>
                        <div class="event-info-box-small">
                            <div>
                                <div class="event-kind">[[event.kind]]</div>
                                <div class="event-date">[[_formatDate(event.date)]]</div>
                            </div>
                            <div>
                                <div class="event-place">[[event.place]]</div>
                                <a class="event-pdf" href="[[event.pdf]]">Event pdf</a>
                            </div>
                        </div>
                    </div>
                    <div class="event-abstract">[[event.abstract]]</div>
                </div>
                <div class="card-content">
                    <a href="/#!speakers/[[event.speaker._id]]" class="event-speaker">
                        <iron-image class="event-speaker-img" sizing="contain" src$="[[event.speaker.picture]]"></iron-image>
                        <div class="event-speaker-info">
                            <div class="event-speaker-name">[[event.speaker.name]]</div>
                            <div class="event-speaker-org">[[event.speaker.organisation]]</div>
                        </div>
                    </a>
                </div>
                <div class="card-content">
                    FEEDBACK
                </div>
            </paper-card>
        </div>

        <iron-ajax
                auto
                url="/events/{{_id}}"
                handle-as="json"
                last-response="{{event}}">
            ></iron-ajax>
    </template>

    <script>
        (function () {
            'use strict';

            Polymer({
                is: 'web-event',
//                ready: function() {
//                    window.singleEvent = this;
//                },
                properties: {
                    _id: {
                        type: String,
                        notify: true
                    },
                    event: {
                        type: Object,
                        notify: true
                    }
                },
                _log: function(s){ console.log(s); },
                _formatDate: function(date) {
                    var d = new Date(date);
                    console.log(d.toDateString());
                    console.log(d.toTimeString());
                    return d.toDateString().slice(3,10) + " - " + d.toTimeString().slice(0,5);
                }

            });


        })();
    </script>

</dom-module>